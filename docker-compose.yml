version: '3.8'

services:
 web:
  build:
   context: .
  ports:
    - 8000:3000
  volumes:
    - ./:/workspace
  depends_on:
    mysqldb:
      condition: service_healthy
  container_name: web

 mysqldb:
  image: mysql
  ports:
    - 33306:3306
  environment:
    MYSQL_ROOT_PASSWORD: root
    MYSQL_DATABASE: taipeibus
  healthcheck:
    test: ["CMD", "mysqladmin", "ping", "-h", "localhost"]
    timeout: 10s
    retries: 5
  volumes:
    - mysql:/var/lib/mysql
    - mysql_config:/etc/mysql
  container_name: db

volumes:
  mysql:
  mysql_config: